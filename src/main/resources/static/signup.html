<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="description" content="" />
    <meta name="author" content="" />
    <!--[if IE]>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <![endif]-->
    <title>SIGN UP</title>
    <!-- BOOTSTRAP CORE STYLE  -->
    <link href="assets/css/bootstrap.css" rel="stylesheet" />
    <!-- FONT AWESOME STYLE  -->
    <link href="assets/css/font-awesome.css" rel="stylesheet" />
    <!-- DATATABLE STYLE  -->
    <link href="assets/js/dataTables/dataTables.bootstrap.css" rel="stylesheet" />
    <!-- CUSTOM STYLE  -->
    <link href="assets/css/style.css" rel="stylesheet" />
    <!-- GOOGLE FONT -->
    <link href='http://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css' />

</head>
<body ng-app="signupApp" ng-controller="signupCtrl">
<div class="navbar navbar-inverse set-radius-zero" >
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <!--<a class="navbar-brand" href="index.html">-->

                <!--<img src="assets/img/logo.png" />-->
            <!--</a>-->
            <h1>学术会议系统</h1>

        </div>

        <div class="right-div">
            <a href="login.html" class="btn btn-info pull-right">LOG IN</a>
        </div>
    </div>
</div>
<!-- LOGO HEADER END-->
<section class="menu-section">
    <div class="container">
        <div class="row">
            <div class="col-md-12">
                <div class="navbar-collapse collapse ">
                    <ul id="menu-top" class="nav navbar-nav navbar-right">
                        <li><a href="index.html" class="fa fa-home">首页</a></li>
                        <li><a href="conferenceList.html" class="fa fa-comments" >会议</a></li>
                        <li><a href="paperList.html" class="fa fa-book" > 论文</a></li>
                        <li><a href="userInfo.html" class=" fa fa-user">个人中心</a></li>

                    </ul>
                </div>
            </div>

        </div>
    </div>
</section>
<!-- MENU SECTION END-->
<div class="content-wrapper">
    <div class="container">
        <!--<div class="row pad-botm">-->
            <!--<div class="col-md-12">-->
                <!--<h4 class="header-line">TABLE EXAMPLES</h4>-->

            <!--</div>-->

        <!--</div>-->
        <div class="row">
            <div class="col-md-6">
        <div class="panel panel-info">
            <div class="panel-heading">
                SING UP （带<span style="color: red">*</span>的为必填项）
            </div>
            <div class="panel-body">
                <form role="form" name="signupForm">

                    <div class="form-group">
                        <label>Enter Email<span style="color: red">*</span></label>
                        <input class="form-control" name="email" type="email"  ng-model="myemail" required/>
                        <!--<span ng-show="signupForm.email.$error.required" style="color: red">邮箱必填</span>-->
                        <span ng-show="signupForm.email.$error.email" style="color: red">非法的邮箱</span>
                        <!--<p class="help-block">Help text here.</p>-->
                    </div>
                    <div class="form-group">
                        <label>Enter Username<span style="color: red">*</span></label>
                        <input class="form-control" type="text" name="username" ng-model="username" required/>
                        <!--<span ng-show="signupForm.username.$error.required" style="color: red">用户名必填</span>-->
                        <!--<p class="help-block">Help text here.</p>-->
                    </div>
                    <div class="form-group">
                        <label>Enter Phone<span style="color: red">*</span></label>
                        <input name="phone" class="form-control" type="text"  ng-model="phone" required/>
                        <!--<p ng-show="signupForm.phone.$error.required" style="color: red">电话号码必填</p>-->
                        <button ng-disabled="signupForm.phone.$invalid" class="btn btn-success" ng-click="getSmsCode()">获取验证码</button>
                        <!--<p class="help-block">Help text here.</p>-->
                    </div>
                    <div class="form-group">
                        <label>Enter 短信验证码<span style="color: red">*</span></label>
                        <input class="form-control" name="sms" type="text"  ng-model="sms" required/>
                        <!--<span ng-show="signupForm.sms.$error.required" style="color: red">短信验证码必填</span>-->
                        <!--<p class="help-block">Help text here.</p>-->
                    </div>
                    <div class="form-group">
                        <label>Enter Password<span style="color: red">*</span></label>
                        <input ng-minlength="6" class="form-control" type="password" ng-model="password" name="password" id="pwd" required/>
                        <!--<p class="help-block">Help text here.</p>-->
                        <!--<span style="color:red" ng-show="signupForm.password.$error.required">密码是必须的.</span>-->
                        <!--<span ng-show="signupForm.password.$error.required" style="color: red">密码必填</span>-->
                        <span style="color:red" ng-show="signupForm.password.$error.minlength">密码至少6位.</span>
                    </div>
                    <div>
                        <label>Re Type Password<span style="color: red">*</span> </label>
                        <input ng-minlength="6" class="form-control"  type="password" ng-model="repassword" name="repassword" id="pwd2" required/>
                        <!--<span ng-show="signupForm.repassword.$error.required" style="color: red">重复密码必填</span>-->
                        <span ng-show="(signupForm.repassword.$error.minlength || repassword!=password)" style="color:red">两次输入的密码不相同.</span>
                        <!--<span style="color:red" ng-show="signupForm.password.$error.required">两侧输入的密码不相同.</span>-->
                    </div>

                    <hr/>
                    <div>
                        <button ng-disabled="signupForm.email.$invalid || signupForm.username.$invalid ||
                        signupForm.phone.$invalid||signupForm.sms.$invalid || signupForm.password.$invalid ||
                         signupForm.repassword.$invalid" ng-click="signup()" class="btn btn-danger">
                            Register Now
                        </button>
                    </div>
                </form>
            </div>
        </div>
        </div>
        </div>

    </div>
</div>
<!-- CONTENT-WRAPPER SECTION END-->
<section class="footer-section">
    <div class="container">
        <div class="row">
            <!--<div class="col-md-12">-->
                <!--&copy; 2014 Yourdomain.com | More Templates <a href="http://www.cssmoban.com/" target="_blank" title="模板之家">模板之家</a> - Collect from <a href="http://www.cssmoban.com/" title="网页模板" target="_blank">网页模板</a></div>-->

        </div>
    </div>
</section>
<!-- FOOTER SECTION END-->
<!-- JAVASCRIPT FILES PLACED AT THE BOTTOM TO REDUCE THE LOADING TIME  -->

<!--<script src="/webjars/angularjs/1.7.7/angular.js"></script>-->
<!-- CORE JQUERY  -->
<script src="assets/js/jquery-1.10.2.js"></script>
<!-- BOOTSTRAP SCRIPTS  -->
<script src="assets/js/bootstrap.js"></script>
<!-- DATATABLE SCRIPTS  -->
<script src="assets/js/dataTables/jquery.dataTables.js"></script>
<script src="assets/js/dataTables/dataTables.bootstrap.js"></script>
<!-- CUSTOM SCRIPTS  -->
<script src="assets/js/custom.js"></script>

<script src="webjars/angularjs/1.6.9/angular.min.js"></script>
<script src="webjars/angularjs/1.6.9/angular-cookies.js"></script>
<script src="assets/js/my.js"></script>
<script>
    app = angular.module('signupApp',['ngCookies']);
    app.controller('signupCtrl',function ($scope,$http) {
        // var token=$cookieStore.get('token');
        // alert("success");
        // alert(token);
        function guid() {
            function S4() {
                return (((1+Math.random())*0x10000)|0).toString(16).substring(1);
            }
            return (S4()+S4()+"-"+S4()+"-"+S4()+"-"+S4()+"-"+S4()+S4()+S4());
        }

        var deviceId = guid();

        $scope.myValue={};
        $scope.signup=function() {
            if($scope.username &&$scope.password&&$scope.phone && $scope.myemail && $scope.repassword && $scope.sms){
                $http({
                    method: 'post',
                    url: 'http://'+myHost+'/user/signup?smscode='+$scope.sms+'&deviceId='+diviceId,
                    headers:{
                        "Content-Type":"application/json;charset=UTF-8"
                    },
                    data: {
                        "name": $scope.username,
                        "password": $scope.password,
                        "phone": $scope.phone,
                        "email": $scope.myemail
                    }
                }).then(function successCallback(reponse) {

                    if(reponse.data.msg == "用户名已经存在"){
                        alert("用户名已经存在");
                    }
                    else if(reponse.data.msg == "邮箱已经存在"){
                        alert("邮箱已经存在");
                    }
                    else if(reponse.data.msg == "电话已经存在"){
                        alert("电话已经存在");
                    }
                    else if(response.data.msg == "failure"){
                        alert(reponse.data.content.toSource);
                    }
                    else {
                        alert("success");
                        window.location.href = "login.html";
                    }
                }, function errorCallback(reponse) {
                    alert('error');
                });
            }
            else {
                alert("还有字段没填写完");
            }

        };

        $scope.getSmsCode=function () {
            $http({
                method:'get',
                url: 'http://'+myHost+'/code/sms/'+deviceId+'?phone='+$scope.phone
            }).then(function successCallback(reponse) {
                alert("验证码已发送");
                // $scope.confs = reponse.data.data;
            },function errorCallback(reponse) {
                alert('error');
            });

        };



    });

</script>
</body>
</html>
